<!doctype html>

<html lang="en" class="h-100">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="generator" content="Hugo 0.69.0" />
  <link rel="stylesheet" href="https://safabayar.tech/css/bootstrap.min.css">
  
  
  <title>Postfix Virtual Host Eklemek | Safa Bayar</title>
  <style>
.container {
  max-width: 700px;
}
#nav a {
  font-weight: bold;
  color: inherit;
}
#nav a.nav-link-active {
  background-color: #212529;
  color: #fff;
}
#nav-border {
  border-bottom: 1px solid #212529;
}
#main {
  margin-top: 1em;
  margin-bottom: 4em;
}
#home-jumbotron {
  background-color: inherit;
}
#footer .container {
  padding: 1em 0;
}
#footer a {
  color: inherit;
  text-decoration: underline;
}
.font-125 {
  font-size: 125%;
}
.tag-btn {
  margin-bottom: 0.3em;
}
pre {
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 16px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit; 
  background-color: transparent;
  border-radius: 0;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 4px;
}
img,
iframe,
embed,
video,
audio {
  max-width: 100%;
}
.card-img,
.card-img-top,
.card-img-bottom {
  width: initial;
}
</style>
 
</head>

  <body class="d-flex flex-column h-100">
    <div id="nav-border" class="container">
  <nav id="nav" class="nav justify-content-center">
  
  
  
    
    
      
      
      
      
      
        
      
    
    
    <a class="nav-link " href="/"><i data-feather="home"></i> Home</a>
  
    
    
      
      
      
      
      
       
        
        
      
    
    
    <a class="nav-link nav-link-active" href="/post/"><i data-feather="edit"></i> Blog</a>
  
    
    
      
      
      
      
      
        
      
    
    
    <a class="nav-link " href="/tags/"><i data-feather="tag"></i> Tags</a>
  
    
    
      
      
      
      
      
        
      
    
    
    <a class="nav-link " href="/about/"><i data-feather="smile"></i> About</a>
  
  </nav>
</div>

    <div class="container">
      <main id="main">
        

<h1>Postfix Virtual Host Eklemek</h1>


<i data-feather="calendar"></i> <time datetime="2019-12-10">Dec 10, 2019</time>

  <br>
  <i data-feather="tag"></i>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://safabayar.tech/tags/linux">linux</a>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://safabayar.tech/tags/lyk">LYK</a>
  
  
  <a class="btn btn-sm btn-outline-dark tag-btn" href="https://safabayar.tech/tags/postfix">postfix</a>
  

<br><br>
<h1 id="virtual-host">Virtual Host</h1>
<p>Virtual host kavramı derste, virtual mail dizinine sahip olanlar, farklı domain adlarına sahip olanlar ve unix kullanıcısı olmayan durumu için anlatıldı. Ben de anladıklarımı ve notlarımı size aktarmaya çalışacağım.</p>
<p>Büyük sistemlerde çok fazla kullanıcı bulunmaktadır ve her biri için domain adı girilmiş olmalıdır. Bundan dolayı çok fazla kaynak ve zaman gerekmektedir. Bu sorunun önüne geçmek için virtual host kavramı kullanılmaktadır.</p>
<p>Virtual host kavramı ise postfix&rsquo;te her alıcı adresi kendisine ait bir tane sanal mail kutusu(virtual mailbox) olmalıdır. Sanal mail kutusuna sahip bir alıcı adresi bir ev dizinine ihtiyacı yoktur. Ek olarak sanal domain tanımlama da kötü domain isimlerin yönlendirmek için de kullanılabilmektedir.</p>
<p>Çalışma mantığı ise postfix, alıcının sanal mail kutularına ararken, kullanıcının mail adresi, uid ve gid&rsquo;lerini tablo üzerinde arayıp ayırmaktadır. Ayırma işlemini &ldquo;/&rdquo; karakterine göre yapmaktadır. Yani virtual host tanımlarken &ldquo;/&rdquo; a çok dikkat edilmelidir.</p>
<pre><code> 1 /etc/postfix/main.cf:
 2     virtual_mailbox_domains = /etc/postfix/vhosts.txt    //example.com ...more domains... file declaration...
 3     virtual_mailbox_base = /var/mail/vhosts
 4     virtual_mailbox_maps = hash:/etc/postfix/vmailbox
 5     virtual_minimum_uid = 100
 6     virtual_uid_maps = static:5000
 7     virtual_gid_maps = static:5000
 8     virtual_alias_maps = hash:/etc/postfix/virtual
 9
10 /etc/postfix/vmailbox:
11     info@example.com    example.com/info
12     sales@example.com   example.com/sales/
13     # Comment out the entry below to implement a catch-all.
14     # @example.com      example.com/catchall
15     ...virtual mailboxes for more domains...
16
17 /etc/postfix/virtual:
18     postmaster@example.com postmaster
</code></pre><ul>
<li>Domainleri bir dosyaya yazıp otomatik olarak kullanıcı adı ve şifrelenmesini sağlanmaktadır. <em>&ldquo;vhosts.txt&rdquo;</em> dosyasının yazımı şu şekilde olmalıdır.</li>
</ul>
<pre><code>domain1.com
domain2.com
virtual.org
</code></pre><ul>
<li>Bu ayarlar yapıldıktan sonra <strong>postmap vhosts.txt</strong> komutu çalıştırılmasıyla domain isimleri şu şekilde değişmektedir.</li>
</ul>
<pre><code>joe@domain1.com domain1.com/joe/
joe@domain2.com domain2.com/joe/
john@virtual.org virtual.org/john/
</code></pre><ul>
<li><strong>postmap /etc/postfix/virtual:</strong> komutun çalıştırılmasıyla virtual dosyası ayarlanmaktadır.</li>
<li><strong>postmap /etc/postfix/vmailbox:</strong> komutunun çalıştırılmasıyla vmailbox dosyası ayarlanmaktadır.</li>
<li><strong>postfix reload:</strong> komutun çalıştırılmasıyla main.cf dosyasında ki ayarlar güncellenmektedir.</li>
</ul>
<p>Oluşturulan virtual domainlerin virtual mail kutuları <em>/var/spool/vmail</em> dizinin altında oluşturulmaktadır. Eğer bu mail kutularının kullanıcı dizinin altında bulunması istenirse şu komutlar uygulanarak otomatik olarak mailler ev dizinin altında toplanması sağlanmaktadır.</p>
<p><strong>Kaynaklar :</strong></p>
<p><a href="https://www.howtoforge.com/linux_postfix_virtual_hosting">www.howtoforge.com/linux_postfix_virtual_hosting</a><br>
<a href="http://www.postfix.org/VIRTUAL_README.html">www.postfix.org/VIRTUAL_README.html</a></p>



      </main>
    </div>
    
<footer id="footer" class="mt-auto text-center text-muted">
  <div class="container">
    
  </div>
</footer>

    <script src="https://safabayar.tech/js/feather.min.js"></script>
<script>
  feather.replace()
</script>


<script src="https://safabayar.tech/js/jquery-3.3.1.slim.min.js"></script>
<script src="https://safabayar.tech/js/bootstrap.bundle.min.js"></script>

    
  

  </body>
</html>